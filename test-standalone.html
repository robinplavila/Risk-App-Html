<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Standalone PDF Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .form-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        input, textarea { margin: 5px; padding: 5px; }
        button { padding: 10px 20px; margin: 10px 5px; }
    </style>
</head>
<body>
    <h1>PDF Generation Test</h1>
    
    <!-- Test form sections -->
    <div class="form-section" data-section="1">
        <h3>Section 1: Sectors</h3>
        <label><input type="checkbox" name="sectors[]" value="ai" checked> AI</label><br>
        <label><input type="checkbox" name="sectors[]" value="defi"> DeFi</label><br>
        <label><input type="checkbox" name="sectors[]" value="robotics" checked> Robotics</label>
    </div>
    
    <div class="form-section" data-section="2">
        <h3>Section 2: General Information</h3>
        <label>Legal Name: <input type="text" name="legal_name" value="Test Company Inc."></label><br>
        <label>Location: <input type="text" name="incorporation_location" value="Ontario, Canada"></label><br>
        <label>Year Established: <input type="number" name="year_established" value="2020"></label><br>
        <label>Employees: <input type="number" name="num_employees" value="25"></label><br>
        <label><input type="radio" name="employees_outside_canada" value="yes" checked> Yes - employees outside Canada</label><br>
        <label><input type="radio" name="employees_outside_canada" value="no"> No - no employees outside Canada</label><br>
        <label>Countries: <input type="text" name="employees_outside_list" value="USA: 5, UK: 2"></label><br>
        <label>Contact Name: <input type="text" name="breach_contact_name" value="John Doe"></label><br>
        <label>Contact Email: <input type="email" name="breach_contact_email" value="john@test.com"></label><br>
    </div>
    
    <button onclick="testCollectData()">Test Data Collection</button>
    <button onclick="simulatePDFGeneration()">Simulate PDF Generation</button>
    
    <div id="output"></div>
    
    <script>
        // Minimal jQuery-like functions
        function $(selector) {
            if (selector.startsWith('.')) {
                return Array.from(document.querySelectorAll(selector));
            }
            return document.querySelector(selector);
        }
        
        function collectFormData() {
            const formData = {
                submissionDate: new Date().toLocaleDateString(),
                submissionTime: new Date().toLocaleTimeString(),
                sectors: [],
                generalInfo: {}
            };

            // Collect sectors
            const sectorInputs = document.querySelectorAll('input[name="sectors[]"]:checked');
            sectorInputs.forEach(input => {
                formData.sectors.push(input.value);
            });

            // Collect section 2 data
            const section2Inputs = document.querySelectorAll('.form-section[data-section="2"] input');
            section2Inputs.forEach(input => {
                const name = input.name;
                const type = input.type;
                
                if (name) {
                    if (type === 'radio') {
                        if (input.checked) {
                            formData.generalInfo[name] = input.value;
                        }
                    } else if (type === 'checkbox') {
                        if (input.checked) {
                            if (!formData.generalInfo[name]) {
                                formData.generalInfo[name] = [];
                            }
                            formData.generalInfo[name].push(input.value);
                        }
                    } else {
                        const value = input.value;
                        if (value && value.trim() !== '') {
                            formData.generalInfo[name] = value;
                        }
                    }
                }
            });

            return formData;
        }
        
        function testCollectData() {
            const data = collectFormData();
            const output = $('#output');
            output.innerHTML = '<h3>Collected Data:</h3><pre>' + JSON.stringify(data, null, 2) + '</pre>';
        }
        
        function simulatePDFGeneration() {
            const formData = collectFormData();
            
            // Simulate the PDF generation logic
            let pdfContent = [];
            
            // Header
            pdfContent.push('='.repeat(50));
            pdfContent.push('Axis Technology Insurance Application');
            pdfContent.push(`Submitted: ${formData.submissionDate} at ${formData.submissionTime}`);
            pdfContent.push('='.repeat(50));
            
            // Section 1: Sectors - Enhanced with questions and options
            pdfContent.push('\nSection 1: Sectors');
            pdfContent.push('-'.repeat(20));
            pdfContent.push('Question: Does your business provide products or services within any of the following sectors?');
            
            const sectorOptions = [
                { value: 'ai', label: '🤖 Artificial Intelligence' },
                { value: 'defi', label: '💰 Decentralized Finance & Digital Assets' },
                { value: 'robotics', label: '🦾 Autonomous Robotics' }
            ];
            
            sectorOptions.forEach(option => {
                const isSelected = formData.sectors.includes(option.value);
                const status = isSelected ? '☑️' : '☐';
                pdfContent.push(`    ${status} ${option.label}`);
            });
            
            // Section 2: General Information
            pdfContent.push('\nSection 2: General Information');
            pdfContent.push('-'.repeat(30));
            
            const section2Questions = [
                { question: '1. Legal Name of Organization', field: 'legal_name', type: 'text' },
                { question: 'Location of Incorporation', field: 'incorporation_location', type: 'text' },
                { question: '6. Year Company Established', field: 'year_established', type: 'number' },
                { question: '7. Number of Employees', field: 'num_employees', type: 'number' },
                {
                    question: '8. Are any Employees based outside of Canada?',
                    field: 'employees_outside_canada',
                    type: 'radio',
                    options: [
                        { value: 'yes', label: 'Yes' },
                        { value: 'no', label: 'No' }
                    ],
                    followUp: {
                        condition: 'yes',
                        question: 'If yes, list the country and the number of employees in each:',
                        field: 'employees_outside_list'
                    }
                },
                {
                    question: '9. Breach Response Contact',
                    fields: [
                        { field: 'breach_contact_name', label: 'Name' },
                        { field: 'breach_contact_email', label: 'Email' }
                    ],
                    type: 'composite'
                }
            ];
            
            section2Questions.forEach(q => {
                pdfContent.push(`\n${q.question}`);
                
                if (q.type === 'text' || q.type === 'textarea' || q.type === 'number') {
                    const value = formData.generalInfo[q.field];
                    pdfContent.push(`    Answer: ${value || 'Not provided'}`);
                } else if (q.type === 'radio') {
                    const selectedValue = formData.generalInfo[q.field];
                    q.options.forEach(option => {
                        const isSelected = selectedValue === option.value;
                        const status = isSelected ? '◉' : '◯';
                        pdfContent.push(`    ${status} ${option.label}`);
                    });
                    
                    // Handle follow-up questions
                    if (q.followUp && selectedValue === q.followUp.condition) {
                        pdfContent.push(`\n    ${q.followUp.question}`);
                        const followUpValue = formData.generalInfo[q.followUp.field];
                        pdfContent.push(`        Answer: ${followUpValue || 'Not provided'}`);
                    }
                } else if (q.type === 'composite') {
                    q.fields.forEach(field => {
                        const value = formData.generalInfo[field.field];
                        pdfContent.push(`    ${field.label}: ${value || 'Not provided'}`);
                    });
                }
            });
            
            const output = $('#output');
            output.innerHTML = '<h3>Simulated PDF Content:</h3><pre>' + pdfContent.join('\n') + '</pre>';
        }
    </script>
</body>
</html>